<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Using Indicators &#8212; backtrader 1.9.69.122 documentation</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxcontrib-images\LightBox2\lightbox2\css\lightbox.css" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-3.3.6/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/mycss-2016-12-25-2300.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/sphinxcontrib-images\LightBox2\lightbox2\js\jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/sphinxcontrib-images\LightBox2\lightbox2\js\lightbox.min.js"></script>
    <script type="text/javascript" src="_static/sphinxcontrib-images\LightBox2\lightbox2-customize\jquery-noconflict.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <script type="text/javascript" src="_static/myjs-2016-12-25-2300.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="TA-Lib" href="talib/talib.html" />
    <link rel="prev" title="Filters" href="filters.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

 <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <!-- <a class="navbar-brand" href="index.html"> -->
        <a class="navbar-brand" href="/">
          backtrader</a>
        <a href="index.html">
	  <span class="navbar-text navbar-version pull-left"><b>1.9.69.122</b></span>
	</a>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav navbar-right"> 
            
                <li><a href="/">Home</a></li>
                <li><a href="/features">Features</a></li>
                <li><a href="/docu">Docs</a></li>
                <li><a href="/blog">Blog</a></li>
                <li><a href="https://community.backtrader.com">Community</a></li>
            
            
	      
              
            
            
            
            
            
          </ul>

          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      <!-- backtrader-001 -->
      <ins class="adsbygoogle"
	   style="display:block"
	   data-ad-client="ca-pub-2694577446631179"
	   data-ad-slot="3977998265"
	   data-ad-format="auto"></ins>
      <script>
	(adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>
  </div>
</div>
<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary">
<form action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
<div class="globaltoc">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Platform Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="operating.html">Operating the platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="exceptions.html">Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="cerebro.html">Cerebro</a></li>
<li class="toctree-l1"><a class="reference internal" href="cerebro/cheat-on-open/cheat-on-open.html">Cheat On Open</a></li>
<li class="toctree-l1"><a class="reference internal" href="strategy.html">Strategy</a></li>
<li class="toctree-l1"><a class="reference internal" href="sizers/sizers.html">Sizers - Smart Staking</a></li>
<li class="toctree-l1"><a class="reference internal" href="timers/timers.html">Timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="order_target/order_target.html">Target Orders</a></li>
<li class="toctree-l1"><a class="reference internal" href="signal_strategy/signal_strategy.html">Strategy with Signals</a></li>
<li class="toctree-l1"><a class="reference internal" href="broker.html">Broker</a></li>
<li class="toctree-l1"><a class="reference internal" href="slippage/slippage.html">Slippage</a></li>
<li class="toctree-l1"><a class="reference internal" href="filler.html">Fillers</a></li>
<li class="toctree-l1"><a class="reference internal" href="order.html">Orders</a></li>
<li class="toctree-l1"><a class="reference internal" href="order-creation-execution/order-creation-execution.html">Order Management and Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="order-creation-execution/oco/oco.html">OCO orders</a></li>
<li class="toctree-l1"><a class="reference internal" href="order-creation-execution/trail/stoptrail.html">StopTrail(Limit)</a></li>
<li class="toctree-l1"><a class="reference internal" href="order-creation-execution/bracket/bracket.html">Bracket Orders</a></li>
<li class="toctree-l1"><a class="reference internal" href="order-creation-execution/futurespot/future-vs-spot.html">Futures and Spot Compensation</a></li>
<li class="toctree-l1"><a class="reference internal" href="datafeed.html">Data Feeds</a></li>
<li class="toctree-l1"><a class="reference internal" href="datafeed-develop-csv.html">CSV Data Feed Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="datafeed-develop-general/datafeed-develop-general.html">Binary Datafeed Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="extending-a-datafeed.html">Extending a Datafeed</a></li>
<li class="toctree-l1"><a class="reference internal" href="pandas-datafeed/pandas-datafeed.html">Pandas DataFeed Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="tradingcalendar/tradingcalendar.html">Trading Calendar</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-resampling/data-resampling.html">Data Resampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-multitimeframe/data-multitimeframe.html">Data - Multiple Timeframes</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-replay/data-replay.html">Data - Replay</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-rollover/rolling-futures-over.html">Rolling over Futures</a></li>
<li class="toctree-l1"><a class="reference internal" href="filters.html">Filters</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using Indicators</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#indicators-in-action">Indicators in action</a></li>
<li class="toctree-l2"><a class="reference internal" href="#init-vs-next"><code class="docutils literal notranslate"><span class="pre">__init__</span></code> vs <code class="docutils literal notranslate"><span class="pre">next</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#during-init">During <code class="docutils literal notranslate"><span class="pre">__init__</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#during-next">During <code class="docutils literal notranslate"><span class="pre">next</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-init-vs-next-why">The <code class="docutils literal notranslate"><span class="pre">__init__</span></code> vs <code class="docutils literal notranslate"><span class="pre">next</span></code> <em>why</em></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#some-notes">Some notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#indicator-plotting">Indicator Plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#controlling-plotting">Controlling plotting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="talib/talib.html">TA-Lib</a></li>
<li class="toctree-l1"><a class="reference internal" href="mixing-timeframes/indicators-mixing-timeframes.html">Mixing Timeframes in Indicators</a></li>
<li class="toctree-l1"><a class="reference internal" href="inddev.html">Indicator Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="observers-and-statistics/observers-and-statistics.html">Observers and Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="observer-benchmark/benchmarking.html">Benchmarking</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyzers/analyzers.html">Analyzers</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyzers/pyfolio.html">PyFolio Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyzers/pyfolio-integration/pyfolio-integration.html">Pyfolio Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="writer.html">Writer</a></li>
<li class="toctree-l1"><a class="reference internal" href="commission-schemes/commission-schemes.html">Commissions: Stocks vs Futures</a></li>
<li class="toctree-l1"><a class="reference internal" href="extending-commissions/commission-schemes-extended.html">Extending Commissions</a></li>
<li class="toctree-l1"><a class="reference internal" href="user-defined-commissions/commission-schemes-subclassing.html">User Defined Commissions</a></li>
<li class="toctree-l1"><a class="reference internal" href="commission-credit.html">Commissions: Credit</a></li>
<li class="toctree-l1"><a class="reference internal" href="position.html">Position</a></li>
<li class="toctree-l1"><a class="reference internal" href="trade.html">Trade</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting/plotting.html">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting/ranges/plotting-date-ranges.html">Plotting Date Ranges</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting/sameaxis/plot-sameaxis.html">Plotting on the same axis</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimization-improvements.html">Optimization improvements</a></li>
<li class="toctree-l1"><a class="reference internal" href="automated-bt-run/automated-bt-run.html">Automating BackTesting</a></li>
<li class="toctree-l1"><a class="reference internal" href="memory-savings/memory-savings.html">Saving Memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="timemgmt.html">DateTime Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="live/live.html">Live Data Feeds and Live Trading</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataautoref.html">Data Feeds Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="datayahoo.html">Yahoo Data Feed Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="indautoref.html">Indicator Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="talibindautoref.html">TA-Lib Indicator Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="strategy-reference.html">Strategies Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyzers-reference.html">Analyzers Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="observers-reference.html">Observers Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="sizers-reference.html">Sizers Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="filters-reference.html">Filters Reference</a></li>
</ul>

</div>
        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="using-indicators">
<h1>Using Indicators<a class="headerlink" href="#using-indicators" title="Permalink to this headline">¶</a></h1>
<p>Indicators can be used in two places in the platform:</p>
<blockquote>
<div><ul class="simple">
<li>Inside Strategies</li>
<li>Inside other Indicators</li>
</ul>
</div></blockquote>
<div class="section" id="indicators-in-action">
<h2>Indicators in action<a class="headerlink" href="#indicators-in-action" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ol class="arabic simple">
<li>Indicators are always instantiated during <code class="docutils literal notranslate"><span class="pre">__init__</span></code> in the <em>Strategy</em></li>
<li>Indicator values (or values thereof derived) are used/checked during
<code class="docutils literal notranslate"><span class="pre">next</span></code></li>
</ol>
</div></blockquote>
<p>There is an important axiom to take into account:</p>
<blockquote>
<div><ul class="simple">
<li>Any <code class="docutils literal notranslate"><span class="pre">Indicator</span></code> (or value thereof derived) declared during <code class="docutils literal notranslate"><span class="pre">__init__</span></code>
will be precalculated before <code class="docutils literal notranslate"><span class="pre">next</span></code> is called.</li>
</ul>
</div></blockquote>
<p>Let’s go for the differences an operation modes.</p>
</div>
<div class="section" id="init-vs-next">
<h2><code class="docutils literal notranslate"><span class="pre">__init__</span></code> vs <code class="docutils literal notranslate"><span class="pre">next</span></code><a class="headerlink" href="#init-vs-next" title="Permalink to this headline">¶</a></h2>
<p>Things works as follows:</p>
<blockquote>
<div><ul class="simple">
<li>Any <strong>operation</strong> involving <strong>lines</strong> objects during <code class="docutils literal notranslate"><span class="pre">__init__</span></code> generates
another <strong>lines</strong> object</li>
<li>Any <strong>operation</strong> involving <strong>lines</strong> objects during <code class="docutils literal notranslate"><span class="pre">next</span></code> yields regular
Python types like floats and bools.</li>
</ul>
</div></blockquote>
<div class="section" id="during-init">
<h3>During <code class="docutils literal notranslate"><span class="pre">__init__</span></code><a class="headerlink" href="#during-init" title="Permalink to this headline">¶</a></h3>
<p>Example of an operation during <code class="docutils literal notranslate"><span class="pre">__init__</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hilo_diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">high</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">low</span>
</pre></div>
</div>
<p>The variable <code class="docutils literal notranslate"><span class="pre">hilo_diff</span></code> holds a reference to a <strong>lines</strong> object which is
precalculated before calling <code class="docutils literal notranslate"><span class="pre">next</span></code> and can be accessed using the standard
array notation <code class="docutils literal notranslate"><span class="pre">[]</span></code></p>
<p>It does obviously contains for each bar of the data feed the difference between
the high and the low.</p>
<p>This also works when mixing simple <strong>lines</strong> (like those in the self.data Data
Feed) and complex ones like indicators:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sma</span> <span class="o">=</span> <span class="n">bt</span><span class="o">.</span><span class="n">SimpleMovingAverage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
<span class="n">close_sma_diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">close</span> <span class="o">-</span> <span class="n">sma</span>
</pre></div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">close_sma_diff</span></code> contains again a <strong>line</strong> object.</p>
<p>Using logical operatorss:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">close_over_sma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">close</span> <span class="o">&gt;</span> <span class="n">sma</span>
</pre></div>
</div>
<p>Now the generated <strong>lines</strong> object will contain an array of booleans.</p>
</div>
<div class="section" id="during-next">
<h3>During <code class="docutils literal notranslate"><span class="pre">next</span></code><a class="headerlink" href="#during-next" title="Permalink to this headline">¶</a></h3>
<p>Example of an operation (logical operator):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">close_over_sma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">close</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">sma</span>
</pre></div>
</div>
<p>Using the equivalent array (index 0 based notation):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">close_over_sma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">close</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">sma</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>In this case <code class="docutils literal notranslate"><span class="pre">close_over_sma</span></code> yields a boolen which is the result of
comparing two floating point values, the ones returned by the <code class="docutils literal notranslate"><span class="pre">[0]</span></code> operator
applied to <code class="docutils literal notranslate"><span class="pre">self.data.close</span></code> and <code class="docutils literal notranslate"><span class="pre">self.sma</span></code></p>
</div>
<div class="section" id="the-init-vs-next-why">
<h3>The <code class="docutils literal notranslate"><span class="pre">__init__</span></code> vs <code class="docutils literal notranslate"><span class="pre">next</span></code> <em>why</em><a class="headerlink" href="#the-init-vs-next-why" title="Permalink to this headline">¶</a></h3>
<p>Logic simplification (and with it ease of use) is the key. Calculations and most
of the associated logic can be declared during <code class="docutils literal notranslate"><span class="pre">__init__</span></code> keeping the actual
operational logic to a minimum during <code class="docutils literal notranslate"><span class="pre">next</span></code>.</p>
<p>There is actually a side benefit: <strong>speed</strong> (due to the precalculation explained
at the beginning)</p>
<p>A complete example which generates a <strong>buy</strong> signal during
<code class="docutils literal notranslate"><span class="pre">__init__</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyStrategy</span><span class="p">(</span><span class="n">bt</span><span class="o">.</span><span class="n">Strategy</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">sma1</span> <span class="o">=</span> <span class="n">btind</span><span class="o">.</span><span class="n">SimpleMovingAverage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">ema1</span> <span class="o">=</span> <span class="n">btind</span><span class="o">.</span><span class="n">ExponentialMovingAverage</span><span class="p">()</span>

        <span class="n">close_over_sma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">close</span> <span class="o">&gt;</span> <span class="n">sma1</span>
        <span class="n">close_over_ema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">close</span> <span class="o">&gt;</span> <span class="n">ema1</span>
        <span class="n">sma_ema_diff</span> <span class="o">=</span> <span class="n">sma</span> <span class="o">-</span> <span class="n">ema</span>

        <span class="n">buy_sig</span> <span class="o">=</span> <span class="n">bt</span><span class="o">.</span><span class="n">And</span><span class="p">(</span><span class="n">close_over_sma</span><span class="p">,</span> <span class="n">close_over_ema</span><span class="p">,</span> <span class="n">sma_ema_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">buy_sig</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buy</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Python’s <code class="docutils literal notranslate"><span class="pre">and</span></code> operator cannot be overriden, forcing the platform to
define its own <code class="docutils literal notranslate"><span class="pre">And</span></code>. The same applies to other constructs like
<code class="docutils literal notranslate"><span class="pre">Or</span></code> and <code class="docutils literal notranslate"><span class="pre">If</span></code></p>
</div>
<p>It should be obvious that the “declarative” approach during <code class="docutils literal notranslate"><span class="pre">__init__</span></code> keeps
the bloating of <code class="docutils literal notranslate"><span class="pre">next</span></code> (where the actual strategy work happens) to a minimum.</p>
<p>(Don’t forget there is also a speed up factor)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When the logic gets really complicated and involves several operations
it is usually much better to encapsulate that inside an
<code class="docutils literal notranslate"><span class="pre">Indicator</span></code>.</p>
</div>
</div>
</div>
<div class="section" id="some-notes">
<h2>Some notes<a class="headerlink" href="#some-notes" title="Permalink to this headline">¶</a></h2>
<p>In the example above there are two things which have been simplified in
<code class="docutils literal notranslate"><span class="pre">backtrader</span></code> when compared to other platforms:</p>
<blockquote>
<div><ul>
<li><p class="first">Declared <code class="docutils literal notranslate"><span class="pre">Indicators</span></code> are neither getting a <strong>parent</strong> parameter (like the
strategy in which they are being created nor is any kind of “register”
method/function being called.</p>
<p>And in spite of it the strategy will kick the calculation of the
<code class="docutils literal notranslate"><span class="pre">Indicators</span></code> and any <strong>lines</strong> object generated because of operations
(like <code class="docutils literal notranslate"><span class="pre">sma</span> <span class="pre">-</span> <span class="pre">ema</span></code>)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">ExponentialMovingAverage</span></code> is being instantiated without <code class="docutils literal notranslate"><span class="pre">self.data</span></code></p>
<p>This is intentional. If no <code class="docutils literal notranslate"><span class="pre">data</span></code> is passed, the 1st data of the
<strong>parent</strong> (in this case the Strategy in which is being created) will be
automatically passed in the background</p>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="indicator-plotting">
<h2>Indicator Plotting<a class="headerlink" href="#indicator-plotting" title="Permalink to this headline">¶</a></h2>
<p>First and foremost:</p>
<blockquote>
<div><ul>
<li><p class="first">Declared <code class="docutils literal notranslate"><span class="pre">Indicators</span></code> get automatically plotted (if cerebro.plot is
called)</p>
</li>
<li><p class="first"><strong>lines</strong> objects from operations DO NOT GET plotted (like <code class="docutils literal notranslate"><span class="pre">close_over_sma</span>
<span class="pre">=</span> <span class="pre">self.data.close</span> <span class="pre">&gt;</span> <span class="pre">self.sma</span></code>)</p>
<p>There is an auxiliary <code class="docutils literal notranslate"><span class="pre">LinePlotterIndicator</span></code> which plots such operations
if wished with the following approach:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">close_over_sma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">close</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">sma</span>
<span class="n">LinePlotterIndicator</span><span class="p">(</span><span class="n">close_over_sma</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Close_over_SMA)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">name</span></code> parameter gives name to the <strong>single</strong> line held by this
indicator.</p>
</li>
</ul>
</div></blockquote>
<div class="section" id="controlling-plotting">
<h3>Controlling plotting<a class="headerlink" href="#controlling-plotting" title="Permalink to this headline">¶</a></h3>
<p>During the development of an <code class="docutils literal notranslate"><span class="pre">Indicator</span></code> a <code class="docutils literal notranslate"><span class="pre">plotinfo</span></code> declaration can be
added. It can be a tuple of tuples (2 elements), a <code class="docutils literal notranslate"><span class="pre">dict</span></code> or an
<code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code>. It looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyIndicator</span><span class="p">(</span><span class="n">bt</span><span class="o">.</span><span class="n">Indicator</span><span class="p">):</span>

    <span class="o">....</span>
    <span class="n">plotinfo</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">subplot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">....</span>
</pre></div>
</div>
<p>The value can be later accessed (and set) as follows (if needed):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myind</span> <span class="o">=</span> <span class="n">MyIndicator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">someparam</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
<span class="n">myind</span><span class="o">.</span><span class="n">plotinfo</span><span class="o">.</span><span class="n">subplot</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>The value can even be set during instantiation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myind</span> <span class="o">=</span> <span class="n">MyIndicator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">someparams</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">subplot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">subplot=True</span></code> will be passed to the (behind the scenes) intantiated
member variable <code class="docutils literal notranslate"><span class="pre">plotinfo</span></code> for the indicator.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">plotinfo</span></code> offers the following parameters to control plotting behavior:</p>
<blockquote>
<div><ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">plot</span></code> (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p>
<p>Whether the indicator is to be plotted or not</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">subplot</span></code> (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p>
<p>Whether to plot the indicator in a different window. For indicators like
moving averages the default is changed to <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">plotname</span></code> (default: <code class="docutils literal notranslate"><span class="pre">''</span></code>)</p>
<p>Sets the plotname to show on the plot. The empty value means the canonical
name of the indicator (<code class="docutils literal notranslate"><span class="pre">class.__name__</span></code>) will be used. This has some
limitations because Python identifiers cannot use for example arithmetic
operators.</p>
<p>An indicator like DI+ will be declared as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DIPlus</span><span class="p">(</span><span class="n">bt</span><span class="o">.</span><span class="n">Indicator</span><span class="p">):</span>
    <span class="n">plotinfo</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">plotname</span><span class="o">=</span><span class="s1">&#39;DI+&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Making the plot “nicer”</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">plotabove</span></code> (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p>
<p>Indicators are usually plotted (those with <code class="docutils literal notranslate"><span class="pre">subplot=True</span></code>) below the data
they have operated on. Setting this to <code class="docutils literal notranslate"><span class="pre">True</span></code> will make the indicator be
plotted above the data.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">plotlinelabels</span></code> (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p>
<p>Meant for “indicators” on “indicators”. If one calculates the
SimpleMovingAverage of the RSI the plot will usually show the name
“SimpleMovingAverage” for the corresponding plotted line. This is the name
of the “Indicator” and not the actual line being plotted.</p>
<p>This default behavior makes sense because the user wants to usually see that
a SimpleMovingAverage has been created using the RSI.</p>
<p>if the value is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> the actual name of the line inside the
SimpleMovingAverage will be used.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">plotymargin</span></code> (default: <code class="docutils literal notranslate"><span class="pre">0.0</span></code>)</p>
<p>Amount of margin to leave at the top and bottom of the indicator (<code class="docutils literal notranslate"><span class="pre">0.15</span></code>
-&gt; 15%). Sometimes the <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> plots go too far to the top/bottom of
the axis and a margin may be wished</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">plotyticks</span></code> (default: <code class="docutils literal notranslate"><span class="pre">[]</span></code>)</p>
<p>Used to control the drawn y scale ticks</p>
<p>If an empty list is passed the “y ticks” will be automatically
calculated. For something like a Stochastic it may make sense to set this to
well-known idustry standards like: <code class="docutils literal notranslate"><span class="pre">[20.0,</span> <span class="pre">50.0,</span> <span class="pre">80.0]</span></code></p>
<p>Some indicators offer parameters like <code class="docutils literal notranslate"><span class="pre">upperband</span></code> and <code class="docutils literal notranslate"><span class="pre">lowerband</span></code> that
are actually used to manipulate the y ticks</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">plothlines</span></code> (default: <code class="docutils literal notranslate"><span class="pre">[]</span></code>)</p>
<p>Used to control the drawing of horizontal lines along the indicator axis.</p>
<p>If an empty list is passed no horizontal lines will drawn.</p>
<p>For something like a Stochastic it may make sense to draw lines for
well-known idustry standards like: <code class="docutils literal notranslate"><span class="pre">[20.0,</span> <span class="pre">80.0]</span></code></p>
<p>Some indicators offer parameters like <code class="docutils literal notranslate"><span class="pre">upperband</span></code> and <code class="docutils literal notranslate"><span class="pre">lowerband</span></code> that
are actually used to manipulate the horizontal lines</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">plotyhlines</span></code> (default: <code class="docutils literal notranslate"><span class="pre">[]</span></code>)</p>
<p>Used to simultaneously control plotyticks and plothlines using a single parameter.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">plotforce</span></code> (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p>
<p>If for some reason you believe an indicator should be plotting and it is not
plotting … set this to <code class="docutils literal notranslate"><span class="pre">True</span></code> as a last resort.</p>
</li>
</ul>
</div></blockquote>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015, 2016, 2017, 2018 Daniel Rodriguez.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>