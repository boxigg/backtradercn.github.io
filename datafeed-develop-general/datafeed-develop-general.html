<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Binary Datafeed Development &#8212; backtrader 1.9.69.122 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxcontrib-images\LightBox2\lightbox2\css\lightbox.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-3.3.6/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mycss-2016-12-25-2300.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/sphinxcontrib-images\LightBox2\lightbox2\js\jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/sphinxcontrib-images\LightBox2\lightbox2\js\lightbox.min.js"></script>
    <script type="text/javascript" src="../_static/sphinxcontrib-images\LightBox2\lightbox2-customize\jquery-noconflict.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <script type="text/javascript" src="../_static/myjs-2016-12-25-2300.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Extending a Datafeed" href="../extending-a-datafeed.html" />
    <link rel="prev" title="CSV Data Feed Development" href="../datafeed-develop-csv.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

 <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <!-- <a class="navbar-brand" href="../index.html"> -->
        <a class="navbar-brand" href="/">
          backtrader</a>
        <a href="../index.html">
	  <span class="navbar-text navbar-version pull-left"><b>1.9.69.122</b></span>
	</a>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav navbar-right"> 
            
                <li><a href="/">Home</a></li>
                <li><a href="/features">Features</a></li>
                <li><a href="/docu">Docs</a></li>
                <li><a href="/blog">Blog</a></li>
                <li><a href="https://community.backtrader.com">Community</a></li>
            
            
	      
              
            
            
            
            
            
          </ul>

          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      <!-- backtrader-001 -->
      <ins class="adsbygoogle"
	   style="display:block"
	   data-ad-client="ca-pub-2694577446631179"
	   data-ad-slot="3977998265"
	   data-ad-format="auto"></ins>
      <script>
	(adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>
  </div>
</div>
<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary">
<form action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
<div class="globaltoc">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts.html">Platform Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operating.html">Operating the platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exceptions.html">Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cerebro.html">Cerebro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cerebro/cheat-on-open/cheat-on-open.html">Cheat On Open</a></li>
<li class="toctree-l1"><a class="reference internal" href="../strategy.html">Strategy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sizers/sizers.html">Sizers - Smart Staking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../timers/timers.html">Timers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../order_target/order_target.html">Target Orders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../signal_strategy/signal_strategy.html">Strategy with Signals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../broker.html">Broker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../slippage/slippage.html">Slippage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filler.html">Fillers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../order.html">Orders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../order-creation-execution/order-creation-execution.html">Order Management and Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../order-creation-execution/oco/oco.html">OCO orders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../order-creation-execution/trail/stoptrail.html">StopTrail(Limit)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../order-creation-execution/bracket/bracket.html">Bracket Orders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../order-creation-execution/futurespot/future-vs-spot.html">Futures and Spot Compensation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datafeed.html">Data Feeds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datafeed-develop-csv.html">CSV Data Feed Development</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Binary Datafeed Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#sample-binary-datafeed">Sample binary datafeed</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#initialization">Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#start">Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stop">Stop</a></li>
<li class="toctree-l3"><a class="reference internal" href="#actual-loading">Actual Loading</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#other-binary-formats">Other Binary Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vchartdata-test">VChartData Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vchartdata-full-code">VChartData Full Code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../extending-a-datafeed.html">Extending a Datafeed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pandas-datafeed/pandas-datafeed.html">Pandas DataFeed Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tradingcalendar/tradingcalendar.html">Trading Calendar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-resampling/data-resampling.html">Data Resampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-multitimeframe/data-multitimeframe.html">Data - Multiple Timeframes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-replay/data-replay.html">Data - Replay</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-rollover/rolling-futures-over.html">Rolling over Futures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filters.html">Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../induse.html">Using Indicators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../talib/talib.html">TA-Lib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mixing-timeframes/indicators-mixing-timeframes.html">Mixing Timeframes in Indicators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inddev.html">Indicator Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../observers-and-statistics/observers-and-statistics.html">Observers and Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../observer-benchmark/benchmarking.html">Benchmarking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analyzers/analyzers.html">Analyzers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analyzers/pyfolio.html">PyFolio Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analyzers/pyfolio-integration/pyfolio-integration.html">Pyfolio Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../writer.html">Writer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commission-schemes/commission-schemes.html">Commissions: Stocks vs Futures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extending-commissions/commission-schemes-extended.html">Extending Commissions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user-defined-commissions/commission-schemes-subclassing.html">User Defined Commissions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commission-credit.html">Commissions: Credit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../position.html">Position</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trade.html">Trade</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plotting/plotting.html">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plotting/ranges/plotting-date-ranges.html">Plotting Date Ranges</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plotting/sameaxis/plot-sameaxis.html">Plotting on the same axis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimization-improvements.html">Optimization improvements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../automated-bt-run/automated-bt-run.html">Automating BackTesting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../memory-savings/memory-savings.html">Saving Memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../timemgmt.html">DateTime Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../live/live.html">Live Data Feeds and Live Trading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataautoref.html">Data Feeds Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datayahoo.html">Yahoo Data Feed Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../indautoref.html">Indicator Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../talibindautoref.html">TA-Lib Indicator Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../strategy-reference.html">Strategies Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analyzers-reference.html">Analyzers Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../observers-reference.html">Observers Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sizers-reference.html">Sizers Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filters-reference.html">Filters Reference</a></li>
</ul>

</div>
        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="binary-datafeed-development">
<h1>Binary Datafeed Development<a class="headerlink" href="#binary-datafeed-development" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The binary file used in the examples <code class="docutils literal notranslate"><span class="pre">goog.fd</span></code> belongs to VisualChart and
cannot be distributed with <code class="docutils literal notranslate"><span class="pre">backtrader</span></code>.</p>
<p class="last"><a class="reference external" href="http://www.visualchart.com">VisualChart</a> can be downloaded free of charge for
those interested in directly using the binary files.</p>
</div>
<p>CSV Data feed development has shown how to add new CSV based data
feeds. The existing base class <cite>CSVDataBase</cite> provides the framework
taking most of the work off the subclasses which in most cases can
simply do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">_loadline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">linetokens</span><span class="p">):</span>

  <span class="c1"># parse the linetokens here and put them in self.lines.close,</span>
  <span class="c1"># self.lines.high, etc</span>

  <span class="k">return</span> <span class="kc">True</span> <span class="c1"># if data was parsed, else ... return False</span>
</pre></div>
</div>
<p>The base class takes care of the parameters, initialization, opening of files,
reading lines, splitting the lines in tokens and additional things like skipping
lines which don’t fit into the date range (<code class="docutils literal notranslate"><span class="pre">fromdate</span></code>, <code class="docutils literal notranslate"><span class="pre">todate</span></code>) which the
end user may have defined.</p>
<p>Developing a non-CSV datafeed follows the same pattern without going down to the
already splitted line tokens.</p>
<p>Things to do:</p>
<blockquote>
<div><ul class="simple">
<li>Derive from backtrader.feed.DataBase</li>
<li>Add any parameters you may need</li>
<li>Should initialization be needed, override <code class="docutils literal notranslate"><span class="pre">__init__(self)</span></code> and/or <code class="docutils literal notranslate"><span class="pre">start(self)</span></code></li>
<li>Should any clean-up code be needed, override <code class="docutils literal notranslate"><span class="pre">stop(self)</span></code></li>
<li>The work happens inside the method which MUST always be overriden: <code class="docutils literal notranslate"><span class="pre">_load(self)</span></code></li>
</ul>
</div></blockquote>
<p>Let’s the parameters already provided by <code class="docutils literal notranslate"><span class="pre">backtrader.feed.DataBase</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">backtrader.utils.py3</span> <span class="k">import</span> <span class="n">with_metaclass</span>

<span class="o">...</span>
<span class="o">...</span>

<span class="k">class</span> <span class="nc">DataBase</span><span class="p">(</span><span class="n">with_metaclass</span><span class="p">(</span><span class="n">MetaDataBase</span><span class="p">,</span> <span class="n">dataseries</span><span class="o">.</span><span class="n">OHLCDateTime</span><span class="p">)):</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;dataname&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;fromdate&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">min</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;todate&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">max</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;compression&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;timeframe&#39;</span><span class="p">,</span> <span class="n">TimeFrame</span><span class="o">.</span><span class="n">Days</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;sessionend&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
</pre></div>
</div>
<p>Having the following meanings:</p>
<blockquote>
<div><ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">dataname</span></code> is what allows the data feed to identify how to fetch the
data. In the case of the <code class="docutils literal notranslate"><span class="pre">CSVDataBase</span></code> this parameter is meant to be a
path to a file or already a file-like object.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">fromdate</span></code> and <code class="docutils literal notranslate"><span class="pre">todate</span></code> define the date range which will be passed to
strategies. Any value provided by the feed outside of this range will be
ignored</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">name</span></code> is cosmetic for plotting purposes</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">timeframe</span></code> indicates the temporal working reference</p>
<p>Potential values: <code class="docutils literal notranslate"><span class="pre">Ticks</span></code>, <code class="docutils literal notranslate"><span class="pre">Seconds</span></code>, <code class="docutils literal notranslate"><span class="pre">Minutes</span></code>, <code class="docutils literal notranslate"><span class="pre">Days</span></code>, <code class="docutils literal notranslate"><span class="pre">Weeks</span></code>,
<code class="docutils literal notranslate"><span class="pre">Months</span></code> and <code class="docutils literal notranslate"><span class="pre">Years</span></code></p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">compression</span></code> (default: 1)</p>
<p>Number of actual bars per bar. Informative. Only effective in Data
Resampling/Replaying.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">compression</span></code></p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">sessionend</span></code> if passed (a datetime.time object) will be added to the
datafeed <code class="docutils literal notranslate"><span class="pre">datetime</span></code> line which allows identifying the end of the session</p>
</li>
</ul>
</div></blockquote>
<div class="section" id="sample-binary-datafeed">
<h2>Sample binary datafeed<a class="headerlink" href="#sample-binary-datafeed" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">backtrader</span></code> already defines a CSV datafeed (<code class="docutils literal notranslate"><span class="pre">VChartCSVData</span></code>) for the
exports of <a class="reference external" href="http://www.visualchart.com">VisualChart</a>, but it is also possible to
directly read the binary data files.</p>
<p>Let’s do it (full data feed code can be found at the bottom)</p>
<div class="section" id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h3>
<p>The binary VisualChart data files can contain either daily (.fd extension) or
intraday data (.min extension). Here the parameter <code class="docutils literal notranslate"><span class="pre">timeframe</span></code>
will be used to distinguish which type of file is being read.</p>
<p>During <code class="docutils literal notranslate"><span class="pre">__init__</span></code> constants which differ for each type are set up.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">VChartData</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

        <span class="c1"># Use the informative &quot;timeframe&quot; parameter to understand if the</span>
        <span class="c1"># code passed as &quot;dataname&quot; refers to an intraday or daily feed</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">timeframe</span> <span class="o">&gt;=</span> <span class="n">TimeFrame</span><span class="o">.</span><span class="n">Days</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">barsize</span> <span class="o">=</span> <span class="mi">28</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dtsize</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">barfmt</span> <span class="o">=</span> <span class="s1">&#39;IffffII&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dtsize</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">barsize</span> <span class="o">=</span> <span class="mi">32</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">barfmt</span> <span class="o">=</span> <span class="s1">&#39;IIffffII&#39;</span>

</pre></div>
</div>
</div>
<div class="section" id="start">
<h3>Start<a class="headerlink" href="#start" title="Permalink to this headline">¶</a></h3>
<p>The Datafeed will be <em>started</em> when backtesting commences (it can actually be
started several times during optimizations)</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">start</span></code> method the binary file is open unless a file-like object has
been passed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># the feed must start ... get the file open (or see if it was open)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dataname</span><span class="p">,</span> <span class="s1">&#39;read&#39;</span><span class="p">):</span>
            <span class="c1"># A file has been passed in (ex: from a GUI)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dataname</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Let an exception propagate</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dataname</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="section" id="stop">
<h3>Stop<a class="headerlink" href="#stop" title="Permalink to this headline">¶</a></h3>
<p>Called when backtesting is finished.</p>
<p>If a file was open, it will be closed</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Close the file if any</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="bp">None</span>

</pre></div>
</div>
</div>
<div class="section" id="actual-loading">
<h3>Actual Loading<a class="headerlink" href="#actual-loading" title="Permalink to this headline">¶</a></h3>
<p>The actual work is done in <code class="docutils literal notranslate"><span class="pre">_load</span></code>. Called to load the next set of data, in
this case the next : datetime, open, high, low, close, volume, openinterest. In
<code class="docutils literal notranslate"><span class="pre">backtrader</span></code> the “actual” moment corresponds to index 0.</p>
<p>A number of bytes will be read from the open file (determined by the constants
set up during <code class="docutils literal notranslate"><span class="pre">__init__</span></code>), parsed with the <code class="docutils literal notranslate"><span class="pre">struct</span></code> module, further
processed if needed (like with divmod operations for date and time) and stored
in the <code class="docutils literal notranslate"><span class="pre">lines</span></code> of the data feed: datetime, open, high, low, close, volume,
openinterest.</p>
<p>If no data can be read from the file it is assumed that the End Of File (EOF)
has been reached</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">False</span></code> is returned to indicate the fact no more data is available</li>
</ul>
</div></blockquote>
<p>Else if data has been loaded and parsed:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">True</span></code> is returned to indicate the loading of the data set was a success</li>
</ul>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">_load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># if no file ... no parsing</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="c1"># Read the needed amount of binary data</span>
        <span class="n">bardata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">barsize</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">bardata</span><span class="p">:</span>
            <span class="c1"># if no data was read ... game over say &quot;False&quot;</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="c1"># use struct to unpack the data</span>
        <span class="n">bdata</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">barfmt</span><span class="p">,</span> <span class="n">bardata</span><span class="p">)</span>

        <span class="c1"># Years are stored as if they had 500 days</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">md</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">bdata</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">500</span><span class="p">)</span>
        <span class="c1"># Months are stored as if they had 32 days</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
        <span class="c1"># put y, m, d in a datetime</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtsize</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Minute Bars</span>
            <span class="c1"># Daily Time is stored in seconds</span>
            <span class="n">hhmm</span><span class="p">,</span> <span class="n">ss</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">bdata</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">60</span><span class="p">)</span>
            <span class="n">hh</span><span class="p">,</span> <span class="n">mm</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">hhmm</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
            <span class="c1"># add the time to the existing atetime</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="n">hh</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="n">mm</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">datetime</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">date2num</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>

        <span class="c1"># Get the rest of the unpacked data</span>
        <span class="n">o</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">oi</span> <span class="o">=</span> <span class="n">bdata</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dtsize</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">open</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">o</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">high</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">low</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">close</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">volume</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">openinterest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">oi</span>

        <span class="c1"># Say success</span>
        <span class="k">return</span> <span class="bp">True</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="other-binary-formats">
<h2>Other Binary Formats<a class="headerlink" href="#other-binary-formats" title="Permalink to this headline">¶</a></h2>
<p>The same model can be applied to any other binary source:</p>
<blockquote>
<div><ul class="simple">
<li>Database</li>
<li>Hierarchical data storage</li>
<li>Online source</li>
</ul>
</div></blockquote>
<p>The steps again:</p>
<blockquote>
<div><ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">__init__</span></code> -&gt; Any init code for the instance, only once</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">start</span></code> -&gt; start of backtesting (one or more times if optimization will be
run)</p>
<p>This would for example open the connection to the database or a socket to an
online service</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">stop</span></code> -&gt; clean-up like closing the database connection or open sockets</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">_load</span></code> -&gt; query the database or online source for the next set of data
and load it into the <code class="docutils literal notranslate"><span class="pre">lines</span></code> of the object. The standard fields being:
datetime, open, high, low, close, volume, openinterest</p>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="vchartdata-test">
<h2>VChartData Test<a class="headerlink" href="#vchartdata-test" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">VCharData</span></code> loading data from a local “.fd” file for Google for the
year 2006.</p>
<p>It’s only about loading the data, so not even a subclass of <code class="docutils literal notranslate"><span class="pre">Strategy</span></code> is
needed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="p">(</span><span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span>
                        <span class="n">unicode_literals</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">datetime</span>

<span class="kn">import</span> <span class="nn">backtrader</span> <span class="kn">as</span> <span class="nn">bt</span>
<span class="kn">from</span> <span class="nn">vchart</span> <span class="kn">import</span> <span class="n">VChartData</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1"># Create a cerebro entity</span>
    <span class="n">cerebro</span> <span class="o">=</span> <span class="n">bt</span><span class="o">.</span><span class="n">Cerebro</span><span class="p">(</span><span class="n">stdstats</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="c1"># Add a strategy</span>
    <span class="n">cerebro</span><span class="o">.</span><span class="n">addstrategy</span><span class="p">(</span><span class="n">bt</span><span class="o">.</span><span class="n">Strategy</span><span class="p">)</span>

    <span class="c1">###########################################################################</span>
    <span class="c1"># Note:</span>
    <span class="c1"># The goog.fd file belongs to VisualChart and cannot be distributed with</span>
    <span class="c1"># backtrader</span>
    <span class="c1">#</span>
    <span class="c1"># VisualChart can be downloaded from www.visualchart.com</span>
    <span class="c1">###########################################################################</span>
    <span class="c1"># Create a Data Feed</span>
    <span class="n">datapath</span> <span class="o">=</span> <span class="s1">&#39;../../datas/goog.fd&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">VChartData</span><span class="p">(</span>
        <span class="n">dataname</span><span class="o">=</span><span class="n">datapath</span><span class="p">,</span>
        <span class="n">fromdate</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2006</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">todate</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2006</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span>
        <span class="n">timeframe</span><span class="o">=</span><span class="n">bt</span><span class="o">.</span><span class="n">TimeFrame</span><span class="o">.</span><span class="n">Days</span>
    <span class="p">)</span>

    <span class="c1"># Add the Data Feed to Cerebro</span>
    <span class="n">cerebro</span><span class="o">.</span><span class="n">adddata</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># Run over everything</span>
    <span class="n">cerebro</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="c1"># Plot the result</span>
    <span class="n">cerebro</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class=""
               data-lightbox="group-ede86af1-294d-46a1-9903-d8723f315a24"
               href="../_images/vchart-goog-20061.png"
               title=""
               data-title=""
               ><img src="../_images/vchart-goog-20061.png"
                     class=""
                     width="100%"
                     height="auto"
                     alt=""/>
                </a></div>
<div class="section" id="vchartdata-full-code">
<h2>VChartData Full Code<a class="headerlink" href="#vchartdata-full-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="p">(</span><span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span>
                        <span class="n">unicode_literals</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">struct</span>

<span class="kn">from</span> <span class="nn">backtrader.feed</span> <span class="kn">import</span> <span class="n">DataBase</span>
<span class="kn">from</span> <span class="nn">backtrader</span> <span class="kn">import</span> <span class="n">date2num</span>
<span class="kn">from</span> <span class="nn">backtrader</span> <span class="kn">import</span> <span class="n">TimeFrame</span>


<span class="k">class</span> <span class="nc">VChartData</span><span class="p">(</span><span class="n">DataBase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">VChartData</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

        <span class="c1"># Use the informative &quot;timeframe&quot; parameter to understand if the</span>
        <span class="c1"># code passed as &quot;dataname&quot; refers to an intraday or daily feed</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">timeframe</span> <span class="o">&gt;=</span> <span class="n">TimeFrame</span><span class="o">.</span><span class="n">Days</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">barsize</span> <span class="o">=</span> <span class="mi">28</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dtsize</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">barfmt</span> <span class="o">=</span> <span class="s1">&#39;IffffII&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dtsize</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">barsize</span> <span class="o">=</span> <span class="mi">32</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">barfmt</span> <span class="o">=</span> <span class="s1">&#39;IIffffII&#39;</span>

    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># the feed must start ... get the file open (or see if it was open)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dataname</span><span class="p">,</span> <span class="s1">&#39;read&#39;</span><span class="p">):</span>
            <span class="c1"># A file has been passed in (ex: from a GUI)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dataname</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Let an exception propagate</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dataname</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Close the file if any</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">_load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># if no file ... no parsing</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="c1"># Read the needed amount of binary data</span>
        <span class="n">bardata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">barsize</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">bardata</span><span class="p">:</span>
            <span class="c1"># if no data was read ... game over say &quot;False&quot;</span>
            <span class="k">return</span> <span class="bp">False</span>

        <span class="c1"># use struct to unpack the data</span>
        <span class="n">bdata</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">barfmt</span><span class="p">,</span> <span class="n">bardata</span><span class="p">)</span>

        <span class="c1"># Years are stored as if they had 500 days</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">md</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">bdata</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">500</span><span class="p">)</span>
        <span class="c1"># Months are stored as if they had 32 days</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
        <span class="c1"># put y, m, d in a datetime</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtsize</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Minute Bars</span>
            <span class="c1"># Daily Time is stored in seconds</span>
            <span class="n">hhmm</span><span class="p">,</span> <span class="n">ss</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">bdata</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">60</span><span class="p">)</span>
            <span class="n">hh</span><span class="p">,</span> <span class="n">mm</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">hhmm</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
            <span class="c1"># add the time to the existing atetime</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="n">hh</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="n">mm</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="n">ss</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">datetime</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">date2num</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>

        <span class="c1"># Get the rest of the unpacked data</span>
        <span class="n">o</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">oi</span> <span class="o">=</span> <span class="n">bdata</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dtsize</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">open</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">o</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">high</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">low</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">close</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">volume</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">openinterest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">oi</span>

        <span class="c1"># Say success</span>
        <span class="k">return</span> <span class="bp">True</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015, 2016, 2017, 2018 Daniel Rodriguez.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>